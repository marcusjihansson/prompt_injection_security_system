# =============================================================================
# Threat Detection System - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control (already in .gitignore)

# -----------------------------------------------------------------------------
# API Keys
# -----------------------------------------------------------------------------

# OpenRouter API Key (Required)
# Used for LLM-based threat detection via OpenRouter
# Get your key at: https://openrouter.ai/keys
OPENROUTER_API_KEY=your_openrouter_api_key_here

# -----------------------------------------------------------------------------
# Training Configuration (Optional)
# -----------------------------------------------------------------------------

# Maximum number of prompt injection examples to use for training
# Default: 50
MAX_PROMPT_INJECTION=50

# Maximum number of jailbreak examples to use for training
# Default: 50
MAX_JAILBREAK=50

# Maximum number of xTRam1 prompt injection examples to use for training
# Default: 100
MAX_XTRAM1_PI=100

# -----------------------------------------------------------------------------
# Demo Configuration (Optional)
# -----------------------------------------------------------------------------

# Path to system prompt JSON file
# Default: system_prompt/system_prompt.json
SYSTEM_PROMPT_PATH=system_prompt/system_prompt.json

# Path to advanced query examples JSON file
# Default: tests/advanced_examples.json
ADVANCED_QUERIES_PATH=tests/advanced_examples.json

# -----------------------------------------------------------------------------
# Model Configuration (Optional)
# -----------------------------------------------------------------------------

# Hugging Face token for downloading models (if needed)
# Get your token at: https://huggingface.co/settings/tokens
# HF_TOKEN=your_huggingface_token_here

# -----------------------------------------------------------------------------
# Production Configuration (Optional)
# -----------------------------------------------------------------------------

# Enable/disable LLM analysis in production
# Default: true
# ENABLE_LLM_ANALYSIS=true

# Maximum requests per minute (rate limiting)
# Default: 60
# MAX_REQUESTS_PER_MINUTE=60

# Maximum input length (characters)
# Default: 5000
# MAX_INPUT_LENGTH=5000

# -----------------------------------------------------------------------------
# Logging (Optional)
# -----------------------------------------------------------------------------

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Default: INFO
# LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Cache Configuration (Optional)
# -----------------------------------------------------------------------------

# Semantic cache similarity threshold (0.0 to 1.0)
# Default: 0.95
# CACHE_SIMILARITY_THRESHOLD=0.95

# Cache TTL in seconds
# Default: 3600 (1 hour)
# CACHE_TTL=3600

# L1 cache size (in-memory LRU cache)
# Default: 1024
# CACHE_L1_SIZE=1024

# L3 cache TTL in seconds (Valkey/Redis distributed cache)
# Default: 3600 (1 hour)
# CACHE_L3_TTL=3600

# Enable L3 distributed cache (Valkey/Redis)
# Default: true
# CACHE_ENABLE_L3=true

# -----------------------------------------------------------------------------
# Valkey/Redis Configuration (Optional - for distributed caching)
# -----------------------------------------------------------------------------

# Valkey/Redis host
# Default: localhost
# VALKEY_HOST=localhost

# Valkey/Redis port
# Default: 6379
# VALKEY_PORT=6379

# Valkey/Redis database number
# Default: 0
# VALKEY_DB=0

# Valkey/Redis password (if authentication is enabled)
# VALKEY_PASSWORD=your_valkey_password_here

# Valkey/Redis socket timeout (seconds)
# Default: 5
# VALKEY_TIMEOUT=5

# Valkey/Redis connection timeout (seconds)
# Default: 5
# VALKEY_CONNECT_TIMEOUT=5

# -----------------------------------------------------------------------------
# Adaptive Detection Configuration (Optional)
# -----------------------------------------------------------------------------

# Enable fast-path optimization (regex patterns for quick decisions)
# Default: true
# ADAPTIVE_ENABLE_FAST_PATH=true

# Confidence threshold for fast-path decisions (0.0 to 1.0)
# Default: 0.85
# ADAPTIVE_CONFIDENCE_THRESHOLD=0.85

# -----------------------------------------------------------------------------
# Connection Pool Configuration (Optional)
# -----------------------------------------------------------------------------

# Maximum number of HTTP connections in pool
# Default: 100
# POOL_MAX_CONNECTIONS=100

# Maximum number of idle connections to keep alive
# Default: 20
# POOL_MAX_KEEPALIVE=20

# Keepalive expiry time (seconds)
# Default: 30.0
# POOL_KEEPALIVE_EXPIRY=30.0

# Request timeout (seconds)
# Default: 30.0
# POOL_TIMEOUT=30.0

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------

# JWT Configuration
# Secret key for JWT tokens (CHANGE THIS IN PRODUCTION!)
JWT_SECRET_KEY=your-secret-key-change-this-in-production

# JWT token expiration time (minutes)
# Default: 30
JWT_EXPIRE_MINUTES=30

# API Key Configuration
# Format: API_KEY_N=key:username:roles (comma-separated)
# Example: API_KEY_1=sk_abc123:admin_user:admin,user
# API_KEY_1=sk_test123:test_user:user
# API_KEY_2=sk_admin456:admin_user:admin,user

# Rate Limiting Configuration
# Default rate limits (format: "N/minute" or "N/hour")
# Default: 100/minute
RATE_LIMIT_DEFAULT=100/minute

# Specific endpoint limits
RATE_LIMIT_DETECT=60/minute
RATE_LIMIT_BATCH=10/minute

# Use Redis for distributed rate limiting
RATE_LIMIT_USE_REDIS=true

# Audit Logging Configuration
# Audit log file path
AUDIT_LOG_FILE=audit.log

# Enable structured logging
AUDIT_USE_STRUCTLOG=true

# Include full request data in audit logs (WARNING: may log sensitive data)
AUDIT_INCLUDE_REQUEST_DATA=false

# Security Headers Configuration
# Enable HTTP Strict Transport Security (HSTS)
SECURITY_ENABLE_HSTS=true

# HSTS max age in seconds (default: 1 year)
SECURITY_HSTS_MAX_AGE=31536000

# Enable Content Security Policy
SECURITY_ENABLE_CSP=true

# CSP directives
SECURITY_CSP_DIRECTIVES=default-src 'self'

# CORS Configuration
# Allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# Input Validation Configuration
# Maximum input length (characters)
INPUT_MAX_LENGTH=10000

# Maximum batch size
INPUT_MAX_BATCH_SIZE=100

# Allow HTML in input
INPUT_ALLOW_HTML=false

# API Configuration
# Enable authentication (set to false for development only)
API_ENABLE_AUTH=true

# Enable rate limiting
API_ENABLE_RATE_LIMIT=true

# Enable audit logging
API_ENABLE_AUDIT_LOG=true

# -----------------------------------------------------------------------------
# Observability Configuration (Tracing & Monitoring)
# -----------------------------------------------------------------------------

# OpenTelemetry Configuration
# Enable distributed tracing
OTEL_ENABLE_TRACING=true

# Service name for tracing
OTEL_SERVICE_NAME=threat-detection-system

# OTLP exporter endpoint (Jaeger, Tempo, etc.)
# Example for Jaeger: http://localhost:4317
# Example for Grafana Tempo: http://localhost:4318
OTEL_EXPORTER_OTLP_ENDPOINT=

# Export traces to console (development only)
OTEL_EXPORT_CONSOLE=false

# Trace sampling rate (0.0 to 1.0)
# 1.0 = trace all requests, 0.1 = trace 10% of requests
OTEL_TRACES_SAMPLER=always_on
OTEL_TRACES_SAMPLER_ARG=1.0

# Prometheus Metrics Configuration
# Enable Prometheus metrics collection
METRICS_ENABLE=true

# Metrics namespace prefix
METRICS_NAMESPACE=threat_detection

# Metrics port (if separate from API)
METRICS_PORT=9090

# Correlation ID Configuration
# HTTP header name for correlation ID
CORRELATION_ID_HEADER=X-Correlation-ID

# Structured Logging Configuration
# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# Log format (json, text)
LOG_FORMAT=json

# Log file path (optional, logs to stdout if not set)
LOG_FILE=

# Include trace IDs in logs
LOG_INCLUDE_TRACE_ID=true
